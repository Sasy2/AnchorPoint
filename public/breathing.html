<!DOCTYPE html>
<html class="light" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Breathing Exercise - Mental Health Coach</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#427cf0",
            "background-light": "#f6f6f8",
            "background-dark": "#101622",
            "accent-blue": "#A0C4FF",
            "accent-lavender": "#BDB2FF",
            "text-light": "#333333",
            "text-dark": "#E0E0E0",
          },
          fontFamily: {
            "display": ["Inter", "sans-serif"]
          },
          borderRadius: {
            "DEFAULT": "0.5rem",
            "lg": "1rem",
            "xl": "1.5rem",
            "full": "9999px"
          },
          animation: {
            'breathe': 'breathe 12s ease-in-out infinite'
          },
          keyframes: {
            breathe: {
              '0%, 100%': { transform: 'scale(0.8)' },
              '50%': { transform: 'scale(1)' },
            }
          }
        },
      },
    }
  </script>
<style>
    .material-symbols-outlined {
      font-variation-settings:
      'FILL' 0,
      'wght' 400,
      'GRAD' 0,
      'opsz' 24
    }
  </style>
</head>
<body class="font-display bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark">
<div class="relative flex min-h-screen w-full flex-col">
<!-- Main Content Area -->
<main class="flex flex-1 flex-col">
<!-- Toolbar -->
<div class="absolute top-0 right-0 p-4 sm:p-6">
<button class="flex h-10 w-10 items-center justify-center rounded-full bg-black/5 dark:bg-white/5 text-text-light dark:text-text-dark hover:bg-black/10 dark:hover:bg-white/10 transition-colors" onclick="goBack()">
<span class="material-symbols-outlined text-2xl">close</span>
</button>
</div>
<div class="flex flex-1 flex-col items-center justify-center p-4 text-center">
<!-- Page Heading -->
<div class="mb-12 max-w-2xl">
<h1 class="text-4xl sm:text-5xl font-black leading-tight tracking-tighter text-text-light dark:text-white">Breathing Exercise</h1>
<p class="mt-3 text-base sm:text-lg text-gray-500 dark:text-gray-400">Follow these steps to calm your mind.</p>
</div>
<!-- Central Interactive Area -->
<div class="relative mb-12 flex h-64 w-64 items-center justify-center sm:h-80 sm:w-80">
<!-- Animated Visual Guide -->
<div id="breathing-circle-1" class="absolute inset-0 z-0 rounded-full bg-accent-blue/20 dark:bg-accent-blue/30"></div>
<div id="breathing-circle-2" class="absolute inset-4 z-0 rounded-full bg-accent-blue/30 dark:bg-accent-blue/40"></div>
<div class="relative z-10 flex flex-col items-center justify-center rounded-full bg-background-light dark:bg-background-dark shadow-lg h-48 w-48 sm:h-56 sm:w-56">
<p id="breathing-instruction" class="text-xl font-bold text-primary dark:text-accent-blue">Breathe In</p>
<p id="breathing-timer" class="text-5xl font-black text-text-light dark:text-white mt-2">4s</p>
</div>
</div>
<!-- Timer -->
<div class="flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-8">
<span class="material-symbols-outlined text-xl">timer</span>
<p id="session-timer" class="text-base font-medium">5:00</p>
</div>
<!-- Action & Progress Controls -->
<div class="w-full max-w-sm">
<!-- Primary CTA Button -->
<button id="start-btn" class="w-full rounded-full bg-primary py-4 px-8 text-lg font-bold text-white transition-transform hover:scale-105 active:scale-100" onclick="startBreathingExercise()">
            Start
          </button>
<!-- Progress Bar -->
<div class="mt-8">
<div class="relative h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700">
<div id="progress-bar" class="absolute top-0 left-0 h-full w-0 rounded-full bg-primary dark:bg-accent-blue transition-all duration-1000"></div>
</div>
</div>
</div>
</div>
</main>
</div>
</div>

<script>
let isBreathing = false;
let breathingInterval;
let sessionInterval;
let sessionTime = 300; // 5 minutes in seconds
let currentPhase = 'inhale'; // inhale, hold, exhale, pause
let phaseTime = 0;
let totalProgress = 0;

const phases = {
    inhale: { duration: 4, instruction: 'Breathe In', color: 'text-primary dark:text-accent-blue' },
    hold: { duration: 4, instruction: 'Hold', color: 'text-yellow-500' },
    exhale: { duration: 4, instruction: 'Breathe Out', color: 'text-green-500' },
    pause: { duration: 2, instruction: 'Pause', color: 'text-gray-500' }
};

function startBreathingExercise() {
    if (!isBreathing) {
        isBreathing = true;
        document.getElementById('start-btn').textContent = 'Pause';
        document.getElementById('start-btn').onclick = pauseBreathingExercise;
        
        startBreathingCycle();
        startSessionTimer();
    }
}

function pauseBreathingExercise() {
    isBreathing = false;
    document.getElementById('start-btn').textContent = 'Resume';
    document.getElementById('start-btn').onclick = startBreathingExercise;
    
    clearInterval(breathingInterval);
    clearInterval(sessionInterval);
}

function startBreathingCycle() {
    if (!isBreathing) return;
    
    const instructionEl = document.getElementById('breathing-instruction');
    const timerEl = document.getElementById('breathing-timer');
    const circle1 = document.getElementById('breathing-circle-1');
    const circle2 = document.getElementById('breathing-circle-2');
    
    const phase = phases[currentPhase];
    phaseTime = phase.duration;
    
    instructionEl.textContent = phase.instruction;
    instructionEl.className = `text-xl font-bold ${phase.color}`;
    
    // Animate circles
    if (currentPhase === 'inhale') {
        circle1.style.transform = 'scale(1)';
        circle2.style.transform = 'scale(1)';
        circle1.style.transition = 'transform 4s ease-in-out';
        circle2.style.transition = 'transform 4s ease-in-out';
    } else if (currentPhase === 'exhale') {
        circle1.style.transform = 'scale(0.8)';
        circle2.style.transform = 'scale(0.8)';
        circle1.style.transition = 'transform 4s ease-in-out';
        circle2.style.transition = 'transform 4s ease-in-out';
    }
    
    breathingInterval = setInterval(() => {
        if (!isBreathing) return;
        
        timerEl.textContent = `${phaseTime}s`;
        phaseTime--;
        
        if (phaseTime < 0) {
            clearInterval(breathingInterval);
            
            // Move to next phase
            const phaseOrder = ['inhale', 'hold', 'exhale', 'pause'];
            const currentIndex = phaseOrder.indexOf(currentPhase);
            currentPhase = phaseOrder[(currentIndex + 1) % phaseOrder.length];
            
            // Update progress
            totalProgress += (phase.duration / 14) * 100; // 14 seconds total per cycle
            document.getElementById('progress-bar').style.width = `${Math.min(totalProgress, 100)}%`;
            
            startBreathingCycle();
        }
    }, 1000);
}

function startSessionTimer() {
    sessionInterval = setInterval(() => {
        if (!isBreathing) return;
        
        sessionTime--;
        const minutes = Math.floor(sessionTime / 60);
        const seconds = sessionTime % 60;
        document.getElementById('session-timer').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        
        if (sessionTime <= 0) {
            endSession();
        }
    }, 1000);
}

function endSession() {
    isBreathing = false;
    clearInterval(breathingInterval);
    clearInterval(sessionInterval);
    
    document.getElementById('start-btn').textContent = 'Complete!';
    document.getElementById('start-btn').onclick = () => {
        window.location.href = 'progress.html';
    };
    
    // Show completion message
    document.getElementById('breathing-instruction').textContent = 'Session Complete!';
    document.getElementById('breathing-timer').textContent = 'âœ“';
}

function goBack() {
    if (isBreathing) {
        if (confirm('Are you sure you want to leave? Your progress will be lost.')) {
            window.location.href = 'activities.html';
        }
    } else {
        window.location.href = 'activities.html';
    }
}

// Dark mode functionality
document.addEventListener('DOMContentLoaded', function() {
    if (localStorage.getItem('darkMode') === 'true') {
        document.documentElement.classList.add('dark');
    }
});
</script>
</body>
</html>
